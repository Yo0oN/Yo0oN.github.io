---
title: Consistent Hashing이란? (feat.Memcached)
modified: 2021-03-24
author: Yo0oN
categories: [Project, 알고리즘]
tags: [알고리즘]
math: true
---

<hr>

## 1. Consistent Hashing?
이전 글 중 Redis와 Memcached를 비교하는 글에서 'Memcached는 ***Consistent Hashing*** 알고리즘을 통해 여러 Memcached 서버에 데이터를 분산 저장하는 기능을 제공합니다'라는 문장을 사용했습니다.

여기서 Consistent Hashing이 어떤것일까요?

Consistent Hashing은 분산 처리 환경에서 사용하는 알고리즘입니다. 서버가 여러개일 때 클라이언트들을 어느 서버로 보내주어야할 지 정할 때 사용하는데요, 이 알고리즘의 특징은 해시함수와 원입니다.<br>

![consistentHashing01](https://user-images.githubusercontent.com/53729311/112190051-fb342f80-8c47-11eb-9db9-2e22da333952.jpg)

일단 서버 4개를 원 위에 올려둡니다. 이제 여러 클라이언트가 서버에 요청을 하면 4개의 서버 중 적절하게 나눠주어야 합니다.<br>
시계처럼 생각해봅시다. 서버1 즉 S1은 12입니다.S2는 3, S3은 6, S4는 9를 가진다고 생각해봅시다.

이제 여러 클라이언트가 요청을 보내고, 처음 요청한 서버에 딱 달라붙어 해당 서버로만 요청을 보내도록 설정해주어야 합니다.<br>
이때 Consistent Hashing은 이름처럼 해시함수를 이용하여 연결시켜줄 서버를 골라줍니다.

![image](https://user-images.githubusercontent.com/53729311/112190855-bceb4000-8c48-11eb-928d-a9ce53c7d843.png)


해시함수를 이용하여 나온 값으로 클라이언트 1부터 6을 각 위치에 두었습니다.<br>
이제 각 클라이언트를 자신보다 큰 숫자를 가진 서버 중 가장 가까운 서버와 연결해줍니다.<br>
C1, C5는 9부터 12사이에 있으니 자신보다 크면서 가장 가까운 위치에 있는 S1과 연결합니다. 다른 클라이언트들도 마찬가지로 서버와 연결합니다.


<hr>

**참고**
- [Consistent Hashing: Explained by The MemCachier Team](https://blog.memcachier.com/2012/06/22/consistent-hashing-explained/)
- [Consistent hashing by Michael Nielsen](https://michaelnielsen.org/blog/consistent-hashing/)
- 
